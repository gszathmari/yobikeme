language: node_js
node_js:
  - '0.10'
  - '0.12'
  - iojs
before_install:
  - npm install -g coffee-script coffeelint mocha mocha-lcov-reporter istanbul coveralls grunt-cli
after_success:
  - mocha --recursive --compilers coffee:coffee-script/register --require coffee-coverage/register-istanbul --reporter mocha-lcov-reporter ./test
  - istanbul report lcov --dir coverage/
  - coveralls < coverage/lcov.info
  - rm -rf coverage/
  - git config --global push.default simple
  - git remote add deploy https://$USER:$PASSWORD@hub.jazz.net/git/gszathmari/yobikeme
  - git push deploy -f
env:
  - YO_API_TOKEN=secret
services:
  - redis-server
branches:
  only:
    - master
    - testing
